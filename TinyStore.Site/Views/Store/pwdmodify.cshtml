<form id="divMain" class="row form-horizontal">
    <div class="col">
        <h4 class="mb-3  bd-text-purple-bright">
            修改密码
        </h4>
        <div class="jumbotron" style="padding: 1rem">
            <i class="fa fa-bullhorn"></i>
            安全提示： 建议您定期更改密码以保护账户安全。密码要牢记在心里，不要透露给别人，建议您不要使用跟其他平台一样的帐号密码，谨防帐号被盗取！
        </div>
        <div class="mt-2 form-horizontal">
            <div class="form-group form-inline row">
                <label class="col-lg-3 control-label">旧密码</label>
                <div class="col-lg-5">
                    <input type="password" class="form-control" placeholder="旧密码" name="PwdOld" maxlength="20" />
                </div>
            </div>
            <div class="form-group form-inline row">
                <label class="col-lg-3 control-label">新密码</label>
                <div class="col-lg-5">
                    <input type="password" class="form-control" placeholder="新密码" name="PwdNew" maxlength="20" />
                </div>
            </div>
            <div class="form-group form-inline row">
                <label class="col-lg-3 control-label">确认新密码</label>
                <div class="col-lg-5">
                    <input type="password" class="form-control" placeholder="确认新密码" name="RePwdNew" maxlength="20" />
                </div>
            </div>
            <div class="form-group form-inline row">
                <div class="form-control-label col-3">
                </div>
                <div class="form-inline  col-4">
                    <a id="btnSave" class="btn btn-primary" href="#">
                        <i class="fa fa-check"></i>保存设置
                    </a>
                </div>
            </div>
        </div>
    </div>
</form>
@section Scripts{
    <script>
        $(function () {
            $("#useraccount").text(user.Account);
            $("#userid").text(user.UserId);

            $("#divMain").find("input[maxlength]").maxlength({
                alwaysShow: true,
                threshold: 10,
                warningClass: "badge badge-success",
                limitReachedClass: "badge badge-danger"
            });

            $("#divMain").validate_popover({
                
                rules: {
                    PwdOld: {
                        required: true,
                        rangelength: [5, 20],
                    },
                    PwdNew: {
                        required: true,
                        rangelength: [5, 20],
                    },
                    RePwdNew: {
                        required: true,
                        equalTo: "[name='PwdNew']"
                    }
                }
            });

            $("#btnSave").on("click", function () {
                if ($("#divMain").valid()) {
                    CY.Ajax("UserPwdModify", {
                        Token: Store.Token()
                    }, {
                        "pwdold": $("#divMain").find("[name='PwdOld']").val(),
                        "pwdnew": $("#divMain").find("[name='PwdNew']").val()
                    }, function (msg) {
                        if (msg.Result) {
                            $.toast("操作成功！");
                        } else {
                            $.toast(msg.Message);
                        }
                        $("#divMain").find(":password").val("");
                    });
                }
                return false;
            });
        });
    </script>
}
